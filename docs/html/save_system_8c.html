<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PatroGalaxy: src/drivers/saveSystem.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">PatroGalaxy
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <span id="MSearchSelect"                onmouseover="return searchBox.OnSearchSelectShow()"                onmouseout="return searchBox.OnSearchSelectHide()">&#160;</span>
          <input type="text" id="MSearchField" value="" placeholder="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('save_system_8c.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">saveSystem.c File Reference</div></div>
</div><!--header-->
<div class="contents">

<p>Implementation of the save system module.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="save_system_8h_source.html">saveSystem.h</a>&quot;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:abe8c79e97a252b83159fb2b9cd4feba6" id="r_abe8c79e97a252b83159fb2b9cd4feba6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#abe8c79e97a252b83159fb2b9cd4feba6">saveProgress</a> (uint8_t *progressString)</td></tr>
<tr class="memdesc:abe8c79e97a252b83159fb2b9cd4feba6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Saves the game progress to flash memory.  <br /></td></tr>
<tr class="separator:abe8c79e97a252b83159fb2b9cd4feba6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97f3554bb9fe5b5ef0b4133d0466c4bd" id="r_a97f3554bb9fe5b5ef0b4133d0466c4bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a97f3554bb9fe5b5ef0b4133d0466c4bd">loadProgress</a> (uint8_t *buffer, size_t tamanho)</td></tr>
<tr class="memdesc:a97f3554bb9fe5b5ef0b4133d0466c4bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads the game progress from flash memory.  <br /></td></tr>
<tr class="separator:a97f3554bb9fe5b5ef0b4133d0466c4bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a634e2b149e308898b57e5312a3c3c858" id="r_a634e2b149e308898b57e5312a3c3c858"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a634e2b149e308898b57e5312a3c3c858">clearSaveData</a> ()</td></tr>
<tr class="memdesc:a634e2b149e308898b57e5312a3c3c858"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clears the saved game data in flash memory.  <br /></td></tr>
<tr class="separator:a634e2b149e308898b57e5312a3c3c858"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71921d9d97a5fc27fa6b78316c4b93e5" id="r_a71921d9d97a5fc27fa6b78316c4b93e5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a71921d9d97a5fc27fa6b78316c4b93e5">createBuffer</a> (uint16_t highscore, uint8_t *buffer)</td></tr>
<tr class="memdesc:a71921d9d97a5fc27fa6b78316c4b93e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a buffer containing the highscore.  <br /></td></tr>
<tr class="separator:a71921d9d97a5fc27fa6b78316c4b93e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad6a9303da56a3af59db3cdc8a538881" id="r_aad6a9303da56a3af59db3cdc8a538881"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#aad6a9303da56a3af59db3cdc8a538881">loadBuffer</a> (uint8_t *buffer, uint16_t *highscore)</td></tr>
<tr class="memdesc:aad6a9303da56a3af59db3cdc8a538881"><td class="mdescLeft">&#160;</td><td class="mdescRight">Loads the number from the buffer array.  <br /></td></tr>
<tr class="separator:aad6a9303da56a3af59db3cdc8a538881"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implementation of the save system module. </p>
<p>This module provides functions for saving and loading game progress to and from the Raspberry Pi Pico W's flash memory. It also handles the creation and loading of the game buffer. </p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a634e2b149e308898b57e5312a3c3c858" name="a634e2b149e308898b57e5312a3c3c858"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a634e2b149e308898b57e5312a3c3c858">&#9670;&#160;</a></span>clearSaveData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clearSaveData </td>
          <td>(</td>
          <td class="paramname"><span class="paramname"><em></em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clears the saved game data in flash memory. </p>
<p>This function erases the flash sector, effectively resetting the game's saved progress.</p>
<dl class="section note"><dt>Note</dt><dd>It is important to use only to erase data of a game or save, don't use if to erase core functions of SO. </dd></dl>

</div>
</div>
<a id="a71921d9d97a5fc27fa6b78316c4b93e5" name="a71921d9d97a5fc27fa6b78316c4b93e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71921d9d97a5fc27fa6b78316c4b93e5">&#9670;&#160;</a></span>createBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void createBuffer </td>
          <td>(</td>
          <td class="paramtype">uint16_t</td>          <td class="paramname"><span class="paramname"><em>highscore</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Creates a buffer containing the highscore. </p>
<p>This function convert a number to array in order to save it to the Flash memory. The highscore is saved as an uint16, but it is converted to a 2-byte array in this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">highscore</td><td>The highscore number to be added to the array </td></tr>
    <tr><td class="paramname">buffer</td><td>The created array </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>For performance and clear memory pourpouses, array size is 2 </dd></dl>

</div>
</div>
<a id="aad6a9303da56a3af59db3cdc8a538881" name="aad6a9303da56a3af59db3cdc8a538881"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad6a9303da56a3af59db3cdc8a538881">&#9670;&#160;</a></span>loadBuffer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loadBuffer </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *</td>          <td class="paramname"><span class="paramname"><em>highscore</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads the number from the buffer array. </p>
<p>This function convert the array to an Number. The highscore is created from a 2-byte array.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>The array to be convertered. </td></tr>
    <tr><td class="paramname">highscore</td><td>pointer to the number that would be saved the array. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>For performance and clear memory pourpouses, array size is 2 </dd></dl>

</div>
</div>
<a id="a97f3554bb9fe5b5ef0b4133d0466c4bd" name="a97f3554bb9fe5b5ef0b4133d0466c4bd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97f3554bb9fe5b5ef0b4133d0466c4bd">&#9670;&#160;</a></span>loadProgress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void loadProgress </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>buffer</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t</td>          <td class="paramname"><span class="paramname"><em>tamanho</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Loads the game progress from flash memory. </p>
<p>This function copies the saved data from flash memory into the provided buffer.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">buffer</td><td>Pointer to the buffer where the loaded data will be stored. </td></tr>
    <tr><td class="paramname">tamanho</td><td>The number of bytes to load. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>It is important that a valid buffer is provided and that it has already been declared and initialized. This function access a flash memory area. </dd></dl>

</div>
</div>
<a id="abe8c79e97a252b83159fb2b9cd4feba6" name="abe8c79e97a252b83159fb2b9cd4feba6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe8c79e97a252b83159fb2b9cd4feba6">&#9670;&#160;</a></span>saveProgress()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void saveProgress </td>
          <td>(</td>
          <td class="paramtype">uint8_t *</td>          <td class="paramname"><span class="paramname"><em>progressString</em></span></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Saves the game progress to flash memory. </p>
<p>This function erases the flash sector and programs the provided data, ensuring that interrupts are disabled during the operation.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">progressString</td><td>Pointer to the data to be saved. Must be less than FLASH_PAGE_SIZE bytes. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section note"><dt>Note</dt><dd>It's crucial that progressString points to a valid buffer, and that its size is less than FLASH_PAGE_SIZE (256 bytes) This function also uses interrupts and a printf command for debug porpuses. </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_c718a368270b13c54d94892d20736f45.html">drivers</a></li><li class="navelem"><a class="el" href="save_system_8c.html">saveSystem.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.2 </li>
  </ul>
</div>
</body>
</html>
